<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rfc PUBLIC "-//IETF//DTD RFC 2629//EN" "http://xml.resource.org/authoring/rfc2629.dtd" [
  <!ENTITY rfc2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
  <!ENTITY rfc6838 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6838.xml">
]>
<?xml-stylesheet type="text/xsl" href="rfc2629.xsl" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>
<?rfc toc="yes" ?>
<?rfc sortrefs="yes" ?>
<?rfc symrefs="yes" ?>
<rfc category="std" ipr="trust200902" submissionType="IETF"
  updates="6838" docName="draft-ietf-mediaman-suffixes-01">
<front>

  <title>Media Types with Multiple Suffixes</title>

  <author initials="M." surname="Sporny" fullname="Manu Sporny">
    <organization>Digital Bazaar</organization>
    <address>
      <postal>
        <street>203 Roanoke Street W.</street>
        <city>Blacksburg</city>
        <region>VA</region>
        <code>24060</code>
        <country>US</country>
      </postal>
      <email>msporny@digitalbazaar.com</email>
      <uri>http://manu.sporny.org/</uri>
    </address>
  </author>

  <author initials="A." surname="Guy" fullname="Amy Guy">
    <organization>Digital Bazaar</organization>
    <address>
      <postal>
        <street>203 Roanoke Street W.</street>
        <city>Blacksburg</city>
        <region>VA</region>
        <code>24060</code>
        <country>US</country>
      </postal>
      <email>rhiaro@digitalbazaar.com</email>
      <uri>https://rhiaro.co.uk/</uri>
    </address>
  </author>

  <date month="February" year="2022" />
  <area>Internet</area>
  <workgroup>MEDIAMAN</workgroup>

  <abstract>
    <t>
This document updates RFC 6838 "Media Type Specifications and Registration
Procedures" to describe how to interpret subtypes with multiple suffixes.
    </t>
  </abstract>

</front>
<middle>
  <section anchor="intro" title="Introduction">
    <t>
As written, RFC 6838 [RFC6838] permits the registration of media type subtype
names which contain any number of occurrences of the "+" character. RFC 6838
defines the characters following the final "+" to be a structured syntax
suffix, but does not define anything further about how to interpret subtype
names containing more than one "+" character.
    </t>
    <t>
This document updates RFC 6838 to clarify how to interpret subtype names
containing more than one "+" character as subtypes with multiple suffixes.
    </t>
    <t>
As registration of media types which use a structured suffix has become widely
supported, this enables further specialization of media types that build on
already registered and well-defined media types which themselves use a
structured suffix.
    </t>

    <section anchor="conventions" title="Conventions Used in This Document">
      <t>
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in [RFC2119] when they
appear in ALL CAPS.  They may also appear in lower or mixed case as
plain English words, without any normative meaning.
      </t>
    </section>
  </section>

  <section anchor="media-types-with-multiple-suffixes" title="Media Types with Multiple Suffixes">
    <t>
The following paragraphs are additions to RFC 6838.
    </t>
    <t>
Media types MAY be registered with more than one suffix appended to the base
subtype name. The suffixes MUST be interpreted as ordered. Valid media type
names containing a structured suffix are built from right to left (not left
to right). Characters on the left-most side of the left-most "+" in a subtype
name specify the base subtype name. Characters to the right of each "+" in
a subtype name denote additional structured syntax suffixes.
    </t>
    <t>
Media types with more than one suffix MUST be registered according to the
procedure defined in [RFC6838]. A new base subtype name MUST only be
registered with suffix combinations that are already registered in their own
right in the
<eref target="https://www.iana.org/assignments/media-type-structured-suffix/media-type-structured-suffix.xhtml">Structured Syntax Suffixes registry</eref>.
    </t>
    <t>
For example, a media type that uses two suffixes, such as
"application/foo+xml+gzip" is only permitted insofar as "+gzip" and "+xml"
are already registered structured syntax suffixes.
    </t>

    <section anchor="processing" title="Processing Multiple Suffixes">
      <t>
Registered subtypes have clear processing rules. In cases where specific
handling of the exact media type is not required, receivers of the media type
MAY do generic processing on the underlying representation
according to their ability to process any subset of the suffix(es) from right
to left inclusive. In other words, an application can choose to ignore the
base subtype name and left-most "+" from a media type with multiple suffixes,
and process according to the remaining media type suffix(es). An application
can ignore as many of the left-most suffixes as necessary to achieve a media
type that can be processed.
      </t>
      <t>
For example, for the media type "application/did+ld+json", applications can
choose to process the underlying representation according any of the following
processing models: 1) application/did+ld+json
(as specified in the  <eref target="https://www.iana.org/assignments/media-types/media-types.xhtml">Media Type Registry</eref>),
2) +ld+json (as specified in the <eref target="https://www.iana.org/assignments/media-type-structured-suffix/media-type-structured-suffix.xhtml">Structured Syntax Suffixes Registry</eref>),
or 3) +json (as specified in the <eref target="https://www.iana.org/assignments/media-type-structured-suffix/media-type-structured-suffix.xhtml">Structured Syntax Suffixes Registry</eref>).
As a further example, for the media type "image/svg+xml+gzip", applications can
choose to process the underlying representation according any of the following
processing models: 1) image/svg+xml+gzip
(as specified in the  <eref target="https://www.iana.org/assignments/media-types/media-types.xhtml">Media Type Registry</eref>),
2) +gzip (as specified in the <eref target="https://www.iana.org/assignments/media-type-structured-suffix/media-type-structured-suffix.xhtml">Structured Syntax Suffixes Registry</eref>),
and then +xml (as specified in the <eref target="https://www.iana.org/assignments/media-type-structured-suffix/media-type-structured-suffix.xhtml">Structured Syntax Suffixes Registry</eref>).
      </t>
      <t>
If an application choses to utilize a portion of the media type that is a
structured syntax suffix, the specification referred to in the  the "Encoding
Considerations" entry of the
<eref target="https://www.iana.org/assignments/media-type-structured-suffix/media-type-structured-suffix.xhtml">
Structured Syntax Suffixes Registry</eref>  MUST be used for both encoding and
decoding the byte stream associated with the media type.
      </t>
    </section>
  </section>

</middle>

<back>
  <references title="Normative References">
&rfc2119;
&rfc6838;
  </references>

  <section anchor="acknowledgements" title="Acknowledgements">
    <t>
The editors would like to thank the following individuals for feedback on the
specification (in alphabetical order): Martin J. DÃ¼rst, Ivan Herman, Graham
Klyne, Murray S. Kucherawy, and Ted Thibodeau Jr.
    </t>
  </section>

</back>
</rfc>
